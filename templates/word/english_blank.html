{% extends 'base.html' %}
{% load pybo_filter %}
{% block content %}
<div class="container my-3">
    <!-- message 표시 -->
    {% if messages %}
    <div class="alert alert-danger my-5" role="alert">
    {% for message in messages %}
        <strong>{{ message.tags }}</strong>
        <ul><li>{{ message.message }}</li></ul>
    {% endfor %}
    </div>
    {% endif %}
    <!-- 시험 -->
    <!--<form method="post">-->
        {% csrf_token %}
        <table>
            <tr>
                <th>한글</th>
                <th>영어</th>
                <th>정답여부</th>
            </tr>
        {% for word in word_list %}
            <tr class="test_field">
                <td>{{word.korean}}</td>
                <td><input type="hidden" name="question" value="{{word.english}}" /><input type="text" name="answer" /> </td>
                <td id="id_{{word.english|replace_space:'_'}}"></td>
            </tr>
        {% endfor %}
        </table>
        <button type="button" onclick="answer_check()">정답 제출</button>
    <h1 id="point"></h1>
    <!--</form>-->
{% endblock %}
{% block script %}
<script type='text/javascript'>

var count = 1;

function answer_check(){
    if(count != 1) {
        alert("재응시는 불가합니다.");
        return false;
    }
    var total = 0;
    var correct = 0;
    $('.test_field input[name="question"]').each(function (index, item) {
        var this_val = $(this).val().replace(/ /gi, "_");
        var answer_val = $(this).next().val().replace(/ /gi, "_");
         if(this_val == answer_val) {
            $("#id_"+this_val).text("O");
            correct += 1;
         } else {
            $("#id_"+this_val).text("X:"+this_val);
        }
        total += 1;
    });
    $("#point").text(Math.round(correct/total*100));
    count++;
}
</script>
{% endblock %}